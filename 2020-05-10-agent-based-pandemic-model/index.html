<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Playing Around with Epi Models - Part 2 | </title><meta name="Description" content="Some experiments with epidemiology models"><meta property="og:title" content="Playing Around with Epi Models - Part 2" />
<meta property="og:description" content="Some experiments with epidemiology models" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://demirev.github.io/2020-05-10-agent-based-pandemic-model/" />
<meta property="og:image" content="https://demirev.github.io/2020-05-10-agent-based-pandemic-model/featured-image.jpg"/>
<meta property="article:published_time" content="2020-05-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-05-10T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://demirev.github.io/2020-05-10-agent-based-pandemic-model/featured-image.jpg"/>
<meta name="twitter:title" content="Playing Around with Epi Models - Part 2"/>
<meta name="twitter:description" content="Some experiments with epidemiology models"/>
<meta name="application-name" content="demirev.github.io">
<meta name="apple-mobile-web-app-title" content="demirev.github.io"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://demirev.github.io/2020-05-10-agent-based-pandemic-model/" /><link rel="prev" href="https://demirev.github.io/2020-04-16-age-specific-seir-model/" /><link rel="next" href="https://demirev.github.io/2021-01-12-social-media-and-polarization/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Playing Around with Epi Models - Part 2",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/demirev.github.io\/2020-05-10-agent-based-pandemic-model\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/demirev.github.io\/2020-05-10-agent-based-pandemic-model\/featured-image.jpg",
                            "width":  1120 ,
                            "height":  467 
                        }],"genre": "posts","keywords": "models","wordCount":  1897 ,
        "url": "https:\/\/demirev.github.io\/2020-05-10-agent-based-pandemic-model\/","datePublished": "2020-05-10T00:00:00+00:00","dateModified": "2020-05-10T00:00:00+00:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/demirev.github.io\/images\/avatar.jpg",
                    "width":  394 ,
                    "height":  394 
                }},"author": {
                "@type": "Person",
                "name": "upagge.en"
            },"description": "Some experiments with epidemiology models"
    }
    </script><script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https:\/\/demirev.github.io"
        },{
            "@type": "ListItem",
            "position": 2,
            "name": "models",
            "item": "https://demirev.github.io/categories/models/"
        },{
                "@type": "ListItem",
                "position": 3,
                "name": "Playing Around with Epi Models - Part 2"
            }]
    }
</script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="demirev.github.io" class="header-logo"><span class="header-title-pre"><i class='fas fa-pencil-alt fa-fw'></i></span>demirev.github.io</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/demirev" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="demirev.github.io" class="header-logo"><span class="header-title-pre"><i class='fas fa-pencil-alt fa-fw'></i></span>demirev.github.io</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/demirev" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main"><div class="container content-article page-toc theme-classic"><div class="toc" id="toc-auto">
            <div class="toc-title">Contents</div>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><div class="header-post">
        <div class="post-title">

            <div class="post-all-meta">
            <div class="breadcrumbs">
    <a href="/">Home </a>/ <a href="/categories/models/">models </a>/ <a href="/"> Playing Around with Epi Models - Part 2 </a>
</div>
            <h1 class="single-title animated flipInX">Playing Around with Epi Models - Part 2</h1><div class="post-meta">
                <div class="post-meta-line"><span class="post-category">
                                <a href="/categories/models/"><i class="far fa-folder fa-fw"></i>&nbsp;models</a>
                            </span>&nbsp;&nbsp;&nbsp;&nbsp;<i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time class="timeago" datetime="2020-05-10">2020-05-10</time>&nbsp;&nbsp;&nbsp;&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1897 words
                    &nbsp;&nbsp;&nbsp;&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;9 minutes</div>
            </div>
        </div>


    </div>

    </div>

        <article class="single toc-start">

        <div class="content-block content-block-first content-block-position">

        <div class="post"><div class="image-theme-classic">
                <img src="/2020-05-10-agent-based-pandemic-model/featured-image.jpg" style="width: 100%">
            </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#model-description---agent-based-pandemic-model">Model Description - Agent-Based Pandemic Model</a></li>
    <li><a href="#possible-future-extensions">Possible Future Extensions</a></li>
    <li><a href="#example">Example</a>
      <ul>
        <li><a href="#defining-social-behavior-of-each-age-group">Defining social behavior of each age group</a></li>
        <li><a href="#creating-a-population-of-agents">Creating a population of agents</a></li>
        <li><a href="#simulating-outbreaks">Simulating outbreaks</a></li>
        <li><a href="#simulating-the-effect-of-different-interventions">Simulating the effect of different interventions</a></li>
        <li><a href="#multiple-simulations-and-non-trivial-policy-schedules">Multiple simulations and non-trivial policy schedules</a></li>
      </ul>
    </li>
    <li><a href="#default-simulation-parameters">Default simulation parameters</a></li>
  </ul>
</nav></div>
            </div><p>As a follow up to my last couple of posts, this is a detailed description of the agent based pandemic model I built on top of <a href="https://www.thelancet.com/journals/laninf/article/PIIS1473-3099%2820%2930457-6/fulltext" target="_blank" rel="noopener noreffer">work</a> by Adam Kucharski et al. as a self-learning exercise.</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title" style="display: none">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Note<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Code for this project can be found at <a href="https://github.com/demirev/2020-cov-abm" target="_blank" rel="noopener noreffer">https://github.com/demirev/2020-cov-abm</a></div>
        </div>
    </div>
<h2 id="model-description---agent-based-pandemic-model">Model Description - Agent-Based Pandemic Model</h2>
<p>The model simulates a population of agents divided in households and workplaces who interact (and expose each other to the disease) on a daily basis.</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="population.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/population.png, population.png 1.5x, /2020-05-10-agent-based-pandemic-model/population.png 1.6x"
        data-sizes="auto"
        alt="Agents in the model"
        title="population.png" /></div></p>
<p>There are four types of agents based on their age group:</p>
<ul>
<li>children</li>
<li>adults</li>
<li>middle-aged</li>
<li>pensioners</li>
</ul>
<p>Every individual belongs to a <strong>household</strong>. The distribution of household in terms of age makeup and size is determined by the user.</p>
<p>Adults and Middle-aged agents are also assigned to <strong>workplaces</strong>. Children are assigned to &lsquo;classrooms&rsquo; with other children. Pensioners are not assigned to a workplace.</p>
<p>The simulation progresses in &lsquo;days&rsquo;. It begins with a small number of infected individuals defined by the user. Each day the infected agents interact with others who become exposed to infection:</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="interactions.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/interactions.png, interactions.png 1.5x, /2020-05-10-agent-based-pandemic-model/interactions.png 1.6x"
        data-sizes="auto"
        alt="Agent interaction"
        title="interactions.png" /></div></p>
<p>I assume that the infected agent meets a number randomly drawn agents from their workplace as well as a number of randomly drawn agents from the population at large. The number of meetings is determined for each infected agent by drawing an observation from the interaction data set from the Pandemic study by <a href="https://www.medrxiv.org/content/10.1101/2020.02.16.20023754v2" target="_blank" rel="noopener noreffer">Krepac et al</a>. Exposed agents face a certain user-defined probability of becoming infected (see section on default parameters).</p>
<p>I assume that infected agents also expose <em>everyone</em> from their own household (at least in the baseline scenario with no interventions). Exposed household members also face a user-defined probability of becoming infectious. For convenience this exposure is done on day 1 of the infection, so this probability should be thought of as the total probability that an exposed household member gets infected throughout the infectious period.</p>
<p>The next day the newly infected agents are added to the list of disease-spreaders and the simulation is carried over again. A simple *SIR status is kept for each agent:</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="status.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/status.png, status.png 1.5x, /2020-05-10-agent-based-pandemic-model/status.png 1.6x"
        data-sizes="auto"
        alt="Agent status"
        title="status.png" /></div></p>
<p>This means that as the disease progresses, the number of susceptible individuals in the population, but also in individual households and workplaces will decrease, and the disease will naturally slow down at some point (note: this will tend to happen earlier because of the compartmentalization of agents into households and workplaces compared to a simulation without this complication).</p>
<p>Throughout the simulation a record is kept of who infected who when. This allows us to compute the <strong>effective average reproduction number</strong> at each time point.</p>
<p>The basic interaction rules described above can be altered by specifying a disease-preventing non-pharmaceutical intervention, which I will cal &lsquo;policies&rsquo; for short.</p>
<p>The list of available policies is given below. It is the same set of interventions as in <a href="https://www.medrxiv.org/content/10.1101/2020.04.23.20077024v1" target="_blank" rel="noopener noreffer">Kucharski et al</a>.</p>
<ul>
<li><strong>no_measures</strong> - the baseline scenario.</li>
<li><strong>isolation_only</strong> - individuals who test positive are isolated and can no longer infect. Only a fraction of infectious agents will get tested each day.</li>
<li><strong>hh_quarantine_only</strong> - in addition to the above, individuals in the household of the ones who tested positive are traced, tested and isolated if needed (i.e. they don&rsquo;t contribute to spreading the infection further).</li>
<li><strong>hh_work_only</strong> - as above plus same treatment of coworkers.</li>
<li><strong>isolation_manual_tracing_met_only</strong> - all contacts are traced (household, work and other) as long as they were contact known to the infected individual beforehand (this is an adjustable parameter). The idea is that in manual tracing you cannot trace stranger.</li>
<li><strong>isolation_manual_tracing_met_limit</strong> - same as above but also imposing a hard limit on number of social interaction outside the household or work (akin to social distancing measures)</li>
<li><strong>isolation_manual_tracing</strong> - assume every contact can be traced (including those that were strangers to the infected individual)</li>
<li><strong>cell_phone</strong> - tracing using smartphone app. Same as isolation_manual_tracing (phone apps allow to trace strangers) but limited by number of people owning a phone.</li>
<li><strong>cell_phone_met_limit</strong> - same as above plus a hard limit on outside of work and home interactions.</li>
<li><strong>pop_testing</strong> - random testing on a certain fraction of the population each day and isolation of those who tested positive only (a la Romer)</li>
<li><strong>pt_extra</strong> - as far as I understand an umbrella for any intervention that reduces the chance of infection given exposure (e.g. mandatory mask wearing). The degree of reduction is a parameter in the model.</li>
</ul>
<h2 id="possible-future-extensions">Possible Future Extensions</h2>
<p>Obviously some aspects of disease spread are simplified in this model. However some complications can be introduced relatively easily. Namely the duration of the disease is currently fixed but can be made variable and dependent on age. SIR groups can be augmented with additional status groups to model hospital admission, ICU care, death or lose of immunity (and the transition between groups can be made dependent on age).</p>
<h2 id="example">Example</h2>
<p>I will give a short example of how to use the model and the code. It is the same one that can be found in the file <code>scripts/contact_abm_model.R</code></p>
<h3 id="defining-social-behavior-of-each-age-group">Defining social behavior of each age group</h3>
<p>Each age group in the model meets with other people based on interaction data such as the one provided by Fry et al. The first step is to define this interaction distribution:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># load contacts data</span>
<span class="n">contacts</span> <span class="o">&lt;-</span> <span class="nf">bind_rows</span><span class="p">(</span>
  <span class="nf">read_csv</span><span class="p">(</span><span class="s">&#34;data/contact_distributions_u18.csv&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">age</span> <span class="o">=</span> <span class="s">&#34;student&#34;</span><span class="p">),</span>
  <span class="nf">read_csv</span><span class="p">(</span><span class="s">&#34;data/contact_distributions_o18.csv&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">age</span> <span class="o">=</span> <span class="s">&#34;adult&#34;</span><span class="p">),</span>
  <span class="nf">read_csv</span><span class="p">(</span><span class="s">&#34;data/contact_distributions_o18.csv&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">age</span> <span class="o">=</span> <span class="s">&#34;middle_age&#34;</span><span class="p">),</span>
  <span class="nf">read_csv</span><span class="p">(</span><span class="s">&#34;data/contact_distributions_o18.csv&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">age</span> <span class="o">=</span> <span class="s">&#34;pensioner&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">e_work</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span> <span class="c1"># pensioners don&#39;t work</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>This is a little coarse since I only have data for over/under 18 rather than for more detailed age brackets, but this can be remedied in the future</p>
<h3 id="creating-a-population-of-agents">Creating a population of agents</h3>
<p>The next step is to create a population of agents for the model. This is done by listing household types and the number of such households to include in the simulation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># define initial population</span>
<span class="n">init_pop</span> <span class="o">&lt;-</span> <span class="nf">generate_population</span><span class="p">(</span>
  <span class="n">household_distribution</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span>
    <span class="nf">tibble</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">100000</span><span class="p">,</span> <span class="n">student</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">adult</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">middle_age</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">pensioner</span> <span class="o">=</span> <span class="m">0</span><span class="p">),</span>
    <span class="nf">tibble</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">100000</span><span class="p">,</span> <span class="n">student</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">adult</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">middle_age</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">pensioner</span> <span class="o">=</span> <span class="m">0</span><span class="p">),</span>
    <span class="nf">tibble</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">10000</span><span class="p">,</span> <span class="n">student</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">adult</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">middle_age</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">pensioner</span> <span class="o">=</span> <span class="m">2</span><span class="p">),</span>
    <span class="nf">tibble</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">50000</span><span class="p">,</span> <span class="n">student</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">adult</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">middle_age</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">pensioner</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
  <span class="p">),</span>
  <span class="n">average_workplace_size</span> <span class="o">=</span> <span class="m">40</span><span class="p">,</span>
  <span class="n">average_classroom_size</span> <span class="o">=</span> <span class="m">25</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>In principle this should be available from census data.</p>
<p>We also need to define the number of initial infected individuals in each age group:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># define initial infected individuals</span>
<span class="n">init_inf</span> <span class="o">&lt;-</span> <span class="nf">generate_initial_infected</span><span class="p">(</span>
  <span class="n">init_pop</span><span class="p">,</span>
  <span class="n">n_initial_infections</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span>
    <span class="s">&#34;student&#34;</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span>
    <span class="s">&#34;adult&#34;</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span>
    <span class="s">&#34;middle_age&#34;</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span>
    <span class="s">&#34;pensioner&#34;</span> <span class="o">=</span> <span class="m">5</span>    
  <span class="p">),</span>
  <span class="n">contact_distribution</span> <span class="o">=</span> <span class="n">contacts</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="simulating-outbreaks">Simulating outbreaks</h3>
<p>The main workhorse function of the model is <code>simulate_pandemic_policy_sequence</code>. It takes the initial population defined above and simulates a sequence of different intervention policies for a specified number of days.</p>
<p>Below I simulate the baseline policy for $120$ days. Note the format of the <code>policy_sequence</code> parameter.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">simulation_baseline</span> <span class="o">&lt;-</span> <span class="nf">simulate_pandemic_policy_sequence</span><span class="p">(</span>
  <span class="n">initial_population</span> <span class="o">=</span> <span class="n">init_pop</span><span class="p">,</span>
  <span class="n">initial_infected</span> <span class="o">=</span> <span class="n">init_inf</span><span class="p">,</span>
  <span class="n">initial_recovered</span> <span class="o">=</span> <span class="nf">tibble</span><span class="p">(</span><span class="n">individual_id</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">)</span><span class="n">[0</span><span class="p">,</span><span class="n">]</span><span class="p">,</span>
  <span class="n">policy_sequence</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="s">&#34;no_measures&#34;</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">120</span><span class="p">)),</span>
  <span class="n">contact_distribution</span> <span class="o">=</span> <span class="n">contacts</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>The code is somewhat time consuming, with this simulation loop taking around 11-12 minutes on my personal laptop.</p>
<p>The resulting data allows us to plot the different <strong>SIR</strong> groups through time:</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="sir_baseline.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/sir_baseline.png, sir_baseline.png 1.5x, /2020-05-10-agent-based-pandemic-model/sir_baseline.png 1.6x"
        data-sizes="auto"
        alt="SIR baseline"
        title="sir_baseline.png" /></div></p>
<p>Or just the number of infected individuals at each day:</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="i_baseline.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/i_baseline.png, i_baseline.png 1.5x, /2020-05-10-agent-based-pandemic-model/i_baseline.png 1.6x"
        data-sizes="auto"
        alt="Infected baseline"
        title="i_baseline.png" /></div>.</p>
<p>Finally we can plot the effective reproduction number at each day (the plot is noisy in the beginning and end of the simulation due to having only a few infected individuals at those times):</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="rt_baseline.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/rt_baseline.png, rt_baseline.png 1.5x, /2020-05-10-agent-based-pandemic-model/rt_baseline.png 1.6x"
        data-sizes="auto"
        alt="R by day"
        title="rt_baseline.png" /></div></p>
<h3 id="simulating-the-effect-of-different-interventions">Simulating the effect of different interventions</h3>
<p>To compare different interventions, I will run one simulation for each intervention scenario, where first the disease spreads unchecked for $20$ days and then the intervention is put in place for $100$ days:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">simulation_all_scenarios</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span>
  <span class="s">&#34;isolation_only&#34;</span><span class="p">,</span><span class="s">&#34;hh_quaratine_only&#34;</span><span class="p">,</span><span class="s">&#34;hh_work_only&#34;</span><span class="p">,</span>
  <span class="s">&#34;isolation_manual_tracing_met_only&#34;</span><span class="p">,</span><span class="s">&#34;isolation_manual_tracing_met_limit&#34;</span><span class="p">,</span>
  <span class="s">&#34;isolation_manual_tracing&#34;</span><span class="p">,</span><span class="s">&#34;cell_phone&#34;</span><span class="p">,</span><span class="s">&#34;cell_phone_met_limit&#34;</span><span class="p">,</span>
  <span class="s">&#34;pop_testing&#34;</span><span class="p">,</span><span class="s">&#34;pt_extra&#34;</span>
<span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">future_map</span><span class="p">(</span><span class="nf">function</span><span class="p">(</span><span class="n">scn</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">simulate_pandemic_policy_sequence</span><span class="p">(</span>
      <span class="n">initial_population</span> <span class="o">=</span> <span class="n">init_pop</span><span class="p">,</span>
      <span class="n">initial_infected</span> <span class="o">=</span> <span class="n">init_inf</span><span class="p">,</span>
      <span class="n">initial_recovered</span> <span class="o">=</span> <span class="nf">tibble</span><span class="p">(</span><span class="n">individual_id</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">)</span><span class="n">[0</span><span class="p">,</span><span class="n">]</span><span class="p">,</span>
      <span class="n">policy_sequence</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span>
        <span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="s">&#34;no_measures&#34;</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">20</span><span class="p">),</span> <span class="c1"># assume 20 days before measures are taken</span>
        <span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="n">scn</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">100</span><span class="p">)</span> <span class="c1"># let simulation run for total of 120 days</span>
      <span class="p">),</span>
      <span class="n">contact_distribution</span> <span class="o">=</span> <span class="n">contacts</span>
    <span class="p">)</span>
  <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>We can now compare the total number of infected (with possible implications for the burden to the healthcare system) for each scenario:</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="i_all_scenarios.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/i_all_scenarios.png, i_all_scenarios.png 1.5x, /2020-05-10-agent-based-pandemic-model/i_all_scenarios.png 1.6x"
        data-sizes="auto"
        alt="Infected all scenarios"
        title="i_all_scenarios.png" /></div></p>
<p>The plot clearly shows that some policies are much more effective than others and some can even lead to disease eradication in these simulations. This is furthers confirmed by looking at $R_t$ for each simulation and noting that it falls well below $1$ for some of them (the plot is noisy at times because of the low number of infected agents at the beginning and end of disease spread):</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="rt_all_scenarios.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/rt_all_scenarios.png, rt_all_scenarios.png 1.5x, /2020-05-10-agent-based-pandemic-model/rt_all_scenarios.png 1.6x"
        data-sizes="auto"
        alt="Disease reproduction all scnearios"
        title="rt_all_scenarios.png" /></div></p>
<h3 id="multiple-simulations-and-non-trivial-policy-schedules">Multiple simulations and non-trivial policy schedules</h3>
<p>The above plots show the results of running the simulation only once per scenario. Since there is inherent randomness in such models, it is better to conduct several simulations and average the results. This can be done through the <code>simulate_pandemic_policy_sequence_ntimes</code> function, which as the name suggests is just a wrapper around <code>simulate_pandemic_policy_sequence</code> that repeats the simulation for a specified number of times.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">simulation_specific_policy</span> <span class="o">&lt;-</span> <span class="nf">simulate_pandemic_policy_sequence_ntimes</span><span class="p">(</span>
  <span class="n">initial_population</span> <span class="o">=</span> <span class="n">init_pop</span><span class="p">,</span>
  <span class="n">initial_infected</span> <span class="o">=</span> <span class="n">init_inf</span><span class="p">,</span>
  <span class="n">initial_recovered</span> <span class="o">=</span> <span class="nf">tibble</span><span class="p">(</span><span class="n">individual_id</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">)</span><span class="n">[0</span><span class="p">,</span><span class="n">]</span><span class="p">,</span>
  <span class="n">policy_sequence</span> <span class="o">=</span> <span class="n">policy</span><span class="p">,</span>
  <span class="n">n_times</span> <span class="o">=</span> <span class="m">8</span><span class="p">,</span> <span class="c1"># run 8 simulations of the same policy</span>
  <span class="n">contact_distribution</span> <span class="o">=</span> <span class="n">contacts</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>One can also use this model to simulate an arbitrary sequence of intervention policies (e.g. a regime of on-and-off social distancing or a policy of initial manual tracing later replaced by cell phone tracing).</p>
<p>To do this just define a <code>policy</code> list as the one below (specifying the duration in days of each policy):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">policy</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span>
  <span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="s">&#34;no_measures&#34;</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span>
  <span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="s">&#34;hh_quaratine_only&#34;</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">20</span><span class="p">),</span>
  <span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="s">&#34;hh_work_only&#34;</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">20</span><span class="p">),</span>
  <span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="s">&#34;isolation_manual_tracing_met_only&#34;</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">20</span><span class="p">),</span>
  <span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="s">&#34;cell_phone&#34;</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">20</span><span class="p">),</span>
  <span class="nf">list</span><span class="p">(</span><span class="n">scenario</span> <span class="o">=</span> <span class="s">&#34;pop_testing&#34;</span><span class="p">,</span> <span class="n">n_days</span> <span class="o">=</span> <span class="m">30</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Plotting the outputs of <code>simulate_pandemic_policy_sequence_ntimes</code> will show the result of each simulation as well as the average across simulations:</p>
<p>

<div style="text-align: center"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="i_complex_policy.png"
        data-srcset="/2020-05-10-agent-based-pandemic-model/i_complex_policy.png, i_complex_policy.png 1.5x, /2020-05-10-agent-based-pandemic-model/i_complex_policy.png 1.6x"
        data-sizes="auto"
        alt="Plot of multiple simulations"
        title="i_complex_policy.png" /></div></p>
<h2 id="default-simulation-parameters">Default simulation parameters</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">inf_period</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="c1"># Infectious period</span>
<span class="n">max_low_fix</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="c1"># Social distancing limit in scenarios with hard limit</span>
<span class="n">wfh_prob</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="c1"># Probability people are working from home</span>
<span class="n">trace_prop</span> <span class="o">=</span> <span class="m">0.95</span><span class="p">,</span> <span class="c1"># Proportion of contacts traced </span>
<span class="n">app_cov</span> <span class="o">=</span> <span class="m">0.53</span><span class="p">,</span> <span class="c1"># App coverage</span>
<span class="n">prob_symp</span> <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span> <span class="c1"># Proportion symptomatic</span>
<span class="n">prob_t_asymp</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span> <span class="c1"># Transmission probability if asymptotic</span>
<span class="n">isolate_distn</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.25</span><span class="p">,</span><span class="m">0.25</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">,</span><span class="m">0</span><span class="p">),</span> <span class="c1"># distribution of time to isolate in the scenarios with isolation (1st day presymp)</span>
<span class="n">pt_extra</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="c1"># Optional extra transmission intervention probability</span>
<span class="n">pt_extra_reduce</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="c1"># Reduction from extra intervention</span>
<span class="n">hh_risk</span> <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> <span class="c1"># HH risk (total)</span>
<span class="n">cc_risk</span> <span class="o">=</span> <span class="m">0.06</span><span class="p">,</span> <span class="c1"># Outside HH contact risk (per daily exposure)</span>
<span class="n">trace_adherence</span> <span class="o">=</span> <span class="m">0.9</span><span class="p">,</span> 
<span class="n">p_pop_test</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> <span class="c1"># Proportion mass tested (5% per week)</span>
<span class="n">trace_hh</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="c1"># Proportion of household members traced in scenarios involving tracing.</span>
<span class="n">met_before_w</span> <span class="o">=</span> <span class="m">0.79</span><span class="p">,</span> <span class="c1"># Proprotion of meetings which are with familiar people at work. At school = 90%</span>
<span class="n">met_before_h</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="c1"># Within HH</span>
<span class="n">met_before_o</span> <span class="o">=</span>  <span class="m">0.52</span> <span class="c1"># In other settings</span>
</code></pre></td></tr></table>
</div>
</div></div>

            <div class="post"><div class="post-info-share">
    <span><a class="share-icon share-twitter" href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://demirev.github.io/2020-05-10-agent-based-pandemic-model/" data-title="Playing Around with Epi Models - Part 2" data-via="georgi_demirev" data-hashtags="models"><i class="fab fa-twitter fa-fw"></i></a><a class="share-icon share-facebook" href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://demirev.github.io/2020-05-10-agent-based-pandemic-model/" data-hashtag="models"><i class="fab fa-facebook-square fa-fw"></i></a></span>
</div>
<div class="footer-post-author">
    <div class="author-avatar"><a href="demirev.github.io" target="_blank"><img alt="" src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fquiin.s3.us-east-1.amazonaws.com%2Fusers%2Fpictures%2F000%2F255%2F626%2Fmedium%2Fgeorgi_cropped.jpg%3F1599562833&amp;f=1&amp;nofb=1" border="0"></a></div>
    <div class="author-info">
        <div class="name"><a href="demirev.github.io" target="_blank">Georgi Demirev</a></div>
        <div class="number-posts">TODO: put some inspirational quote here</span></div>
    </div>
</div><div class="footer-donate">
    <div>hope you enjoyed the read</div>
</div><div class="post-footer" id="post-footer"><div class="post-navigation"><div class="post-nav-box nav-box-prev">
            <a class="nav-box" href="/2020-04-16-age-specific-seir-model/"><span class="nav-icon"><svg aria-hidden="true" data-prefix="fas" data-icon="chevron-circle-left" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zM142.1 273l135.5 135.5c9.4 9.4 24.6 9.4 33.9 0l17-17c9.4-9.4 9.4-24.6 0-33.9L226.9 256l101.6-101.6c9.4-9.4 9.4-24.6 0-33.9l-17-17c-9.4-9.4-24.6-9.4-33.9 0L142.1 239c-9.4 9.4-9.4 24.6 0 34z"></path></svg></span><div style="text-align: right;padding-left: 10px"><div class="nav-text-h">Next article</div><span class="nav-text">Playing Around with Epi Models - Part 1</span></div></a>
        </div>
        <div class="post-nav-box nav-box-next">
            <a class="nav-box" href="/2021-01-12-social-media-and-polarization/"><div style="padding-right: 10px"><div class="nav-text-h">Next article</div><span class="nav-text">Социалните мрежи и политическата поляризация</span></div><span class="nav-icon"><svg aria-hidden="true" data-prefix="fas" data-icon="chevron-circle-right" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zm113.9 231L234.4 103.5c-9.4-9.4-24.6-9.4-33.9 0l-17 17c-9.4 9.4-9.4 24.6 0 33.9L285.1 256 183.5 357.6c-9.4 9.4-9.4 24.6 0 33.9l17 17c9.4 9.4 24.6 9.4 33.9 0L369.9 273c9.4-9.4 9.4-24.6 0-34z"></path></svg></span></a>
        </div></div></div>
</div>
        </div>
    <div id="toc-final"></div>
    </article><div class=" post-tags post-tags-toc "><a href="/tags/models/" class="tag">models</a></div><div class="page single comments content-block-position"><div id="comments"><div id="remark42" class="comment" style="padding-top: 1.5rem"></div>
            <script>
                var themeRemark = document.body.getAttribute('theme')
                var remark_config = {
                    host: 'https:\/\/comments.upagge.ru',
                    site_id: 'documentation',
                    components: ['embed'],
                    theme: themeRemark,
                    locale: 'en',
                    show_email_subscription: '',
                    page_title: 'Playing Around with Epi Models - Part 2'
                };

                (function(c) {
                    for(var i = 0; i < c.length; i++){
                        var d = document, s = d.createElement('script');
                        s.src = remark_config.host + '/web/' +c[i] +'.js';
                        s.defer = true;
                        (d.head || d.body).appendChild(s);
                    }
                })(remark_config.components || ['embed']);
            </script></div></div></div></main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.80.0">Hugo</a> | Theme - <a href="https://ublogger.netlify.app/?utm_source=https://demirev.github.io&utm_medium=footer&utm_campaign=config&utm_term=1.2.0" target="_blank" title="uBlogger 1.2.0"><i class="fas fa-pencil-alt fa-fw"></i> uBlogger</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span>2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="demirev.github.io" target="_blank">demirev</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css"><script src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js"></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script src="/js/theme.min.js"></script><script src="/js/jquery-3.5.1.min.js"></script></body>
</html>
